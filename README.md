# BankIntegrationIPN
BankIntegrationIPN is a web-based service designed to integrate and process payment notifications from banks via an 
Instant Payment Notification (IPN) system. The system processes payment information, 
validates checksums to ensure secure data transmission, and stores transaction details in a database.

### Requirements
<ol>
    <li>Dot Net Core 8.0 runtime or SDK </li>
    <li>SQL Server - A database for storing student info and payment data. </li>
    <li>Visual Studio 2019 or Later</li>
    <li>Postman or Curl (optional but recommended) - For testing the API endpoints.</li>
</ol>

### Tools and Technologies
<ol>
    <li>ASP.NET Core 8.0: A cross-platform, high-performance framework for building APIs.</li>
    <li>Entity Framework Core: An object-relational mapper (ORM) for database management.</li>
    <li>SQL Server: Relational database management for transaction storage.</li>
    <li> Swagger / Swashbuckle: For API documentation and testing.</li>
    <li>HMAC-SHA256: Used for checksum generation and validation to ensure secure data integrity.</li>
</ol>

### How It Works
  BankIntegrationIPN facilitates the receipt of payment notifications (IPN) from a banking system. The core features of the system include:
  
  <li>Payment Processing: The system receives transaction data from banks via the IPN endpoint.</li>
  <li>Checksum Validation: Each transaction is validated using a checksum to ensure the data has not been tampered with. The checksum is generated by hashing transaction data along with a secret key (provided in the configuration).</li>
  <li>Database Storage: Valid transactions are stored in a relational database.</li>

### Database Relationships and Schema
The project uses SQL Server to store payment transaction details. Below are the core entities in the database:
<li>Payments Table: Stores details of each payment transaction such as:</li>
<ul>
      <li>Id:(primary key)</li>
      <li>TranId: Transaction ID (primary key)</li>
      <li>StudentId: Reference to the student the payment belongs to.</li>
      <li>Amount: The amount paid.</li>
      <li>DatePaid: Date of payment.</li>
      <li>ResultCode: Result of the payment transaction.</li>
      <li>ResponseMessage: Bank response message.</li>
      <li>ReceiptNumber: Payment receipt number.</li>
      <li>Checksum: Checksum used for data validation.</li>
  </ul>
<li>Student Table: Stores student enrollment data such as:</li>
<ul>
      <li>Id: (primary key)</li>
      <li>RegNo: Student registration number (Unique)</li>
      <li>FirstName: Student first name.</li>
      <li>LastName:Student first name.</li>
      <li>YearOfStudy: Student Year of payment.</li>
   
  </ul>
  A student can have multiple payments,and each payment must be associated with a student:

### System Architecture
<ol>
    <li>Controller Layer: Exposes API endpoints to receive IPN requests and process payments.</li>
    <li>Service Layer: Contains the business logic, including checksum validation.</li>
    <li>Data Layer: Manages the database context and handles all interactions with the SQL Server database using Entity Framework Core.</li>
    <li>Configuration Layer: Handles application settings and configurations (e.g., secret keys for checksum validation).</li>
</ol>

### Core Components:
<ol>
    <li>PaymentController: Receives HTTP requests and validates payment data.</li>
    <li>PaymentService: Contains logic for validating and generating checksums.</li>
    <li>PaymentSettings: Stores configuration settings such as secret keys for checksum generation.</li>
</ol>

### Assumptions
<ul>
    <li> The bank bank has already processed the payment and the school only expects a callback.</li>
    <li> Both the school and the bank already have a secret key that they use to verify payments</li>
</ul>
